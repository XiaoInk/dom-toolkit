<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´åŠŸèƒ½æµ‹è¯• - DOM Toolkit</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            line-height: 1.6;
            background: #f5f5f5;
        }
        .demo-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #2196F3;
        }
        button {
            margin: 5px;
            padding: 10px 15px;
            cursor: pointer;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 4px;
            transition: all 0.3s;
        }
        button:hover {
            background: #1976D2;
            transform: translateY(-1px);
        }
        .test-area {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
            border: 2px dashed #dee2e6;
            min-height: 100px;
        }
        .input-field {
            width: 300px;
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .draggable {
            width: 100px;
            height: 50px;
            background: #4CAF50;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: move;
            margin: 10px;
            border-radius: 4px;
            user-select: none;
        }
        .target-area {
            width: 200px;
            height: 100px;
            border: 2px dashed #ff9800;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px;
            border-radius: 4px;
            background: #fff3e0;
        }
        .scroll-content {
            height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            padding: 15px;
            background: white;
        }
        .scroll-content p {
            height: 100px;
            margin: 20px 0;
            padding: 10px;
            background: #e3f2fd;
            border-radius: 4px;
        }
        .log {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 10px 0;
        }
        .coordinates-display {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            display: none;
        }
    </style>
</head>
<body>
    <h1>ğŸš€ DOM Toolkit å®Œæ•´åŠŸèƒ½æµ‹è¯•</h1>
    
    <!-- åæ ‡æ˜¾ç¤ºå™¨ -->
    <div class="coordinates-display" id="coordinates-display">
        X: 0, Y: 0
    </div>

    <div class="demo-section">
        <h2>ğŸ–±ï¸ ç‚¹å‡»å’Œè¾“å…¥æµ‹è¯•</h2>
        <button onclick="testClick1()">ç‚¹å‡»è¾“å…¥æ¡† 1</button>
        <button onclick="testClick2()">ç‚¹å‡»è¾“å…¥æ¡† 2</button>
        <button onclick="testTypeInput1()">åœ¨è¾“å…¥æ¡† 1 ä¸­è¾“å…¥æ–‡å­—</button>
        <button onclick="testDoubleClick()">åŒå‡»æ ‡é¢˜</button>
        <button onclick="testRightClick()">å³é”®ç‚¹å‡»æ­¤åŒºåŸŸ</button>
        
        <div class="test-area">
            <input class="input-field" id="input1" placeholder="è¾“å…¥æ¡† 1" value="">
            <input class="input-field" id="input2" placeholder="è¾“å…¥æ¡† 2" value="">
            <h3 id="title">åŒå‡»æµ‹è¯•æ ‡é¢˜</h3>
        </div>
    </div>

    <div class="demo-section">
        <h2>ğŸ¯ æ‹–æ‹½æµ‹è¯•</h2>
        <button onclick="testDrag()">æ‹–æ‹½ç»¿è‰²æ–¹å—åˆ°æ©™è‰²åŒºåŸŸ</button>
        
        <div class="test-area">
            <div class="draggable" id="draggable">æ‹–æ‹½æˆ‘</div>
            <div class="target-area" id="target">ç›®æ ‡åŒºåŸŸ</div>
        </div>
    </div>

    <div class="demo-section">
        <h2>ğŸ“œ æ»šåŠ¨æµ‹è¯•</h2>
        <button onclick="testScrollDown()">å‘ä¸‹æ»šåŠ¨</button>
        <button onclick="testScrollUp()">å‘ä¸Šæ»šåŠ¨</button>
        <button onclick="testScrollToElement()">æ»šåŠ¨åˆ°æ®µè½ 5</button>
        <button onclick="testScrollAndClick()">æ»šåŠ¨å¹¶ç‚¹å‡»æ®µè½ 3</button>
        
        <div class="scroll-content" id="scroll-content">
            <p id="para1">æ®µè½ 1 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬ä¸€æ®µã€‚</p>
            <p id="para2">æ®µè½ 2 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬äºŒæ®µã€‚</p>
            <p id="para3">æ®µè½ 3 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬ä¸‰æ®µã€‚</p>
            <p id="para4">æ®µè½ 4 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬å››æ®µã€‚</p>
            <p id="para5">æ®µè½ 5 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬äº”æ®µã€‚</p>
            <p id="para6">æ®µè½ 6 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬å…­æ®µã€‚</p>
            <p id="para7">æ®µè½ 7 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬ä¸ƒæ®µã€‚</p>
            <p id="para8">æ®µè½ 8 - è¿™æ˜¯æ»šåŠ¨æµ‹è¯•å†…å®¹çš„ç¬¬å…«æ®µã€‚</p>
        </div>
    </div>

    <div class="demo-section">
        <h2>ğŸ” å…ƒç´ æ£€æµ‹æµ‹è¯•</h2>
        <button onclick="testElementDetection()">æ£€æµ‹å½“å‰ä½ç½®å…ƒç´ </button>
        <button onclick="testHighlight()">é«˜äº®æ˜¾ç¤ºæ ‡é¢˜</button>
        <button onclick="toggleRealtimeDetection()">å¯åŠ¨/åœæ­¢å®æ—¶æ£€æµ‹</button>
        
        <div class="test-area">
            <div id="detection-result">æ£€æµ‹ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
    </div>

    <div class="demo-section">
        <h2>ğŸ“¦ æ‰¹é‡æ“ä½œæµ‹è¯•</h2>
        <button onclick="testBatchOperations()">æ‰§è¡Œæ‰¹é‡æ“ä½œåºåˆ—</button>
        <button onclick="testBatchScrollAndClick()">æ‰¹é‡æ»šåŠ¨å’Œç‚¹å‡»</button>
        
        <div class="test-area">
            <div id="batch-result">æ‰¹é‡æ“ä½œç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
        </div>
    </div>

    <div class="demo-section">
        <h2>ğŸ“Š æµ‹è¯•æ—¥å¿—</h2>
        <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
        <div id="log" class="log">ç­‰å¾…æµ‹è¯•...</div>
    </div>

    <!-- åŠ è½½æ‰€æœ‰æ¨¡å— -->
    <script src="../dist/index.js"></script>
    <script src="../dist/modules/coordinate.min.iife.js"></script>
    <script src="../dist/modules/detector.min.iife.js"></script>
    <script src="../dist/modules/interactor.min.iife.js"></script>
    <script src="../dist/modules/scroller.min.iife.js"></script>
    
    <script>
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logDiv.textContent = logEntry + '\n' + logDiv.textContent;
        }

        function clearLog() {
            document.getElementById('log').textContent = 'æ—¥å¿—å·²æ¸…ç©º...\n';
        }

        function updateCoordinatesDisplay(x, y) {
            const display = document.getElementById('coordinates-display');
            display.textContent = `X: ${x}, Y: ${y}`;
            display.style.display = 'block';
        }

        async function testClick1() {
            try {
                const input1 = document.getElementById('input1');
                const rect = input1.getBoundingClientRect();
                await domToolkit.click(rect.left + 5, rect.top + 5);
                log('âœ… æˆåŠŸç‚¹å‡»è¾“å…¥æ¡† 1');
            } catch (error) {
                log(`âŒ ç‚¹å‡»è¾“å…¥æ¡† 1 å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testClick2() {
            try {
                const input2 = document.getElementById('input2');
                const rect = input2.getBoundingClientRect();
                await domToolkit.click(rect.left + 5, rect.top + 5);
                log('âœ… æˆåŠŸç‚¹å‡»è¾“å…¥æ¡† 2');
            } catch (error) {
                log(`âŒ ç‚¹å‡»è¾“å…¥æ¡† 2 å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testTypeInput1() {
            try {
                const input1 = document.getElementById('input1');
                const rect = input1.getBoundingClientRect();
                await domToolkit.type(rect.left + 5, rect.top + 5, 'Hello DOM Toolkit!', {
                    clear: true,
                    typingDelay: 50
                });
                log('âœ… æˆåŠŸåœ¨è¾“å…¥æ¡† 1 ä¸­è¾“å…¥æ–‡å­—');
            } catch (error) {
                log(`âŒ è¾“å…¥æ–‡å­—å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testDoubleClick() {
            try {
                const title = document.getElementById('title');
                const rect = title.getBoundingClientRect();
                await domToolkit.doubleClick(rect.left + 10, rect.top + 10);
                log('âœ… æˆåŠŸåŒå‡»æ ‡é¢˜');
                title.style.color = '#ff5722';
                setTimeout(() => {
                    title.style.color = '';
                }, 2000);
            } catch (error) {
                log(`âŒ åŒå‡»å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testRightClick() {
            try {
                const demoSection = document.querySelector('.demo-section');
                const rect = demoSection.getBoundingClientRect();
                await domToolkit.rightClick(rect.left + 10, rect.top + 10);
                log('âœ… æˆåŠŸæ‰§è¡Œå³é”®ç‚¹å‡»');
            } catch (error) {
                log(`âŒ å³é”®ç‚¹å‡»å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testDrag() {
            try {
                const draggable = document.getElementById('draggable');
                const target = document.getElementById('target');
                const dragRect = draggable.getBoundingClientRect();
                const targetRect = target.getBoundingClientRect();
                
                await domToolkit.drag(
                    dragRect.left + 50, dragRect.top + 25,
                    targetRect.left + 100, targetRect.top + 50,
                    { duration: 1000 }
                );
                log('âœ… æˆåŠŸæ‹–æ‹½å…ƒç´ åˆ°ç›®æ ‡åŒºåŸŸ');
                target.textContent = 'æ‹–æ‹½æˆåŠŸï¼';
                target.style.background = '#4CAF50';
            } catch (error) {
                log(`âŒ æ‹–æ‹½å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testScrollDown() {
            try {
                await domToolkit.scroll('down', 200);
                log('âœ… æˆåŠŸå‘ä¸‹æ»šåŠ¨');
            } catch (error) {
                log(`âŒ å‘ä¸‹æ»šåŠ¨å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testScrollUp() {
            try {
                await domToolkit.scroll('up', 200);
                log('âœ… æˆåŠŸå‘ä¸Šæ»šåŠ¨');
            } catch (error) {
                log(`âŒ å‘ä¸Šæ»šåŠ¨å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testScrollToElement() {
            try {
                await domToolkit.scrollToElement('#para5');
                log('âœ… æˆåŠŸæ»šåŠ¨åˆ°æ®µè½ 5');
            } catch (error) {
                log(`âŒ æ»šåŠ¨åˆ°å…ƒç´ å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testScrollAndClick() {
            try {
                const para3 = document.getElementById('para3');
                const rect = para3.getBoundingClientRect();
                
                await domToolkit.scrollAndClick(0, rect.top - 100, rect.left + 50, rect.top + 50);
                log('âœ… æˆåŠŸæ»šåŠ¨å¹¶ç‚¹å‡»æ®µè½ 3');
                para3.style.background = '#ffeb3b';
                setTimeout(() => {
                    para3.style.background = '';
                }, 2000);
            } catch (error) {
                log(`âŒ æ»šåŠ¨å¹¶ç‚¹å‡»å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testElementDetection() {
            try {
                // æ£€æµ‹é¡µé¢ä¸­é—´ä½ç½®çš„å…ƒç´ 
                const centerX = window.innerWidth / 2;
                const centerY = window.innerHeight / 2;
                
                const elementInfo = window.domToolkitDetector.getElementAt(centerX, centerY);
                const resultDiv = document.getElementById('detection-result');
                
                if (elementInfo) {
                    resultDiv.innerHTML = `
                        <strong>æ£€æµ‹åˆ°å…ƒç´ :</strong><br>
                        æ ‡ç­¾: ${elementInfo.tagName}<br>
                        ID: ${elementInfo.id || 'æ— '}<br>
                        ç±»å: ${elementInfo.className || 'æ— '}<br>
                        æ–‡æœ¬: ${elementInfo.textContent.substring(0, 50)}...
                    `;
                    log('âœ… æˆåŠŸæ£€æµ‹å…ƒç´ ');
                } else {
                    resultDiv.innerHTML = 'æœªæ£€æµ‹åˆ°å…ƒç´ ';
                    log('âš ï¸ æœªæ£€æµ‹åˆ°å…ƒç´ ', 'warning');
                }
            } catch (error) {
                log(`âŒ å…ƒç´ æ£€æµ‹å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testHighlight() {
            try {
                const title = document.getElementById('title');
                const rect = title.getBoundingClientRect();
                
                window.domToolkitDetector.highlightAt(rect.left + 50, rect.top + 10, 2000);
                log('âœ… æˆåŠŸé«˜äº®æ˜¾ç¤ºæ ‡é¢˜');
            } catch (error) {
                log(`âŒ é«˜äº®æ˜¾ç¤ºå¤±è´¥: ${error.message}`, 'error');
            }
        }

        let realtimeDetectionActive = false;
        
        function toggleRealtimeDetection() {
            try {
                if (realtimeDetectionActive) {
                    window.domToolkitDetector.stopRealtimeDetection();
                    realtimeDetectionActive = false;
                    log('ğŸ›‘ åœæ­¢å®æ—¶æ£€æµ‹');
                } else {
                    window.domToolkitDetector.startRealtimeDetection();
                    realtimeDetectionActive = true;
                    log('â–¶ï¸ å¯åŠ¨å®æ—¶æ£€æµ‹ï¼ˆæŒ‰ä½ Ctrl é”®ç§»åŠ¨é¼ æ ‡ï¼‰');
                }
            } catch (error) {
                log(`âŒ å®æ—¶æ£€æµ‹æ“ä½œå¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testBatchOperations() {
            try {
                const input1 = document.getElementById('input1');
                const rect = input1.getBoundingClientRect();
                
                const operations = [
                    { click: { x: rect.left + 5, y: rect.top + 5, options: {} } },
                    { type: { x: rect.left + 5, y: rect.top + 5, text: 'æ‰¹é‡æµ‹è¯•', options: { clear: true } } }
                ];
                
                const results = await domToolkit.batch(operations, { delayBetween: 500 });
                
                const resultDiv = document.getElementById('batch-result');
                resultDiv.innerHTML = `<strong>æ‰¹é‡æ“ä½œå®Œæˆ:</strong> æ‰§è¡Œäº† ${results.length} ä¸ªæ“ä½œ`;
                log('âœ… æˆåŠŸæ‰§è¡Œæ‰¹é‡æ“ä½œ');
            } catch (error) {
                log(`âŒ æ‰¹é‡æ“ä½œå¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testBatchScrollAndClick() {
            try {
                const operations = [
                    { scroll: { direction: 'down', distance: 300 } },
                    { scroll: { direction: 'up', distance: 150 } }
                ];
                
                const results = await domToolkit.batchOperate(operations, { 
                    scrollDelay: 500,
                    operationDelay: 300
                });
                
                const resultDiv = document.getElementById('batch-result');
                resultDiv.innerHTML = `<strong>æ‰¹é‡æ»šåŠ¨å®Œæˆ:</strong> æ‰§è¡Œäº† ${results.length} ä¸ªæ“ä½œ`;
                log('âœ… æˆåŠŸæ‰§è¡Œæ‰¹é‡æ»šåŠ¨æ“ä½œ');
            } catch (error) {
                log(`âŒ æ‰¹é‡æ»šåŠ¨æ“ä½œå¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        window.addEventListener('load', () => {
            log('ğŸš€ DOM Toolkit å®Œæ•´åŠŸèƒ½æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            log('ğŸ“‹ å¯ç”¨æ¨¡å—: domToolkit, domToolkitCoordinates, domToolkitDetector, domToolkitInteractor, domToolkitScroller');
            
            // å¯åŠ¨åæ ‡æ˜¾ç¤ºï¼ˆç”¨äºæ¼”ç¤ºï¼‰
            if (window.domToolkitCoordinates) {
                window.domToolkitCoordinates.startDisplay();
                log('â–¶ï¸ åæ ‡æ˜¾ç¤ºå·²å¯åŠ¨');
                
                // 10ç§’åè‡ªåŠ¨å…³é—­åæ ‡æ˜¾ç¤º
                setTimeout(() => {
                    window.domToolkitCoordinates.stopDisplay();
                    log('â¹ï¸ åæ ‡æ˜¾ç¤ºå·²è‡ªåŠ¨å…³é—­');
                }, 10000);
            }
        });

        // ç›‘å¬é¼ æ ‡ç§»åŠ¨ä»¥æ›´æ–°åæ ‡æ˜¾ç¤º
        document.addEventListener('mousemove', (e) => {
            updateCoordinatesDisplay(e.clientX, e.clientY);
        });
    </script>
</body>
</html>