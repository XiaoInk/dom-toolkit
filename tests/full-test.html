<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DOM Toolkit å®Œæ•´åŠŸèƒ½éªŒè¯</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .test-button { background: #007bff; color: white; border: none; padding: 8px 16px; margin: 5px; border-radius: 3px; cursor: pointer; }
        .test-button:hover { background: #0056b3; }
        .status { position: fixed; top: 10px; right: 10px; background: rgba(0,0,0,0.8); color: white; padding: 10px 15px; border-radius: 5px; max-width: 300px; z-index: 10002; box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .test-area { width: 150px; height: 60px; background: #28a745; color: white; display: flex; align-items: center; justify-content: center; margin: 10px 0; border-radius: 3px; cursor: pointer; user-select: none; }
        .input-test { padding: 8px; margin: 5px; border: 1px solid #ddd; border-radius: 3px; width: 200px; }
        .scroll-content { height: 1500px; background: linear-gradient(to bottom, #f0f0f0, #e0e0e0); padding: 20px; margin: 20px 0; }
        .result { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 3px; }
        .pass { color: #28a745; font-weight: bold; }
        .fail { color: #dc3545; font-weight: bold; }
        .highlight { background: yellow !important; transition: background 0.3s; }
    </style>
</head>
<body>
    <h1>ğŸš€ DOM Toolkit å®Œæ•´åŠŸèƒ½éªŒè¯</h1>
    <div id="status" class="status">å‡†å¤‡éªŒè¯...</div>
    
    <div class="test-section">
        <h2>ğŸ“¦ æ¨¡å—åŠ è½½éªŒè¯</h2>
        <button class="test-button" onclick="loadAllModules()">åŠ è½½æ‰€æœ‰æ¨¡å—</button>
        <button class="test-button" onclick="testModuleLoading()">æ£€æŸ¥æ¨¡å—çŠ¶æ€</button>
        <div id="loading-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ–±ï¸ åæ ‡æ˜¾ç¤ºéªŒè¯</h2>
        <button class="test-button" onclick="testCoordinates()">å¯åŠ¨åæ ‡æ˜¾ç¤º</button>
        <button class="test-button" onclick="stopCoordinates()">åœæ­¢åæ ‡æ˜¾ç¤º</button>
        <div id="coordinates-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ¯ å…ƒç´ æ£€æµ‹éªŒè¯</h2>
        <div class="test-area" id="detect-target">æ£€æµ‹ç›®æ ‡</div>
        <button class="test-button" onclick="testElementDetection()">æ£€æµ‹æ­¤å…ƒç´ </button>
        <button class="test-button" onclick="testHighlight()">é«˜äº®æ­¤å…ƒç´ </button>
        <button class="test-button" onclick="startRealtimeDetection()">å¯åŠ¨å®æ—¶æ£€æµ‹</button>
        <div id="detection-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ–±ï¸ ç‚¹å‡»éªŒè¯</h2>
        <div class="test-area" id="click-target" onclick="this.textContent='ç‚¹å‡»æˆåŠŸ!'">ç‚¹å‡»ç›®æ ‡</div>
        <button class="test-button" onclick="testClick()">æµ‹è¯•è‡ªåŠ¨ç‚¹å‡»</button>
        <button class="test-button" onclick="testDoubleClick()">æµ‹è¯•åŒå‡»</button>
        <button class="test-button" onclick="testRightClick()">æµ‹è¯•å³é”®</button>
        <div id="click-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>âŒ¨ï¸ è¾“å…¥éªŒè¯</h2>
        <input type="text" id="test-input" class="input-test" placeholder="æµ‹è¯•è¾“å…¥æ¡†">
        <button class="test-button" onclick="testType()">æµ‹è¯•è‡ªåŠ¨è¾“å…¥</button>
        <button class="test-button" onclick="clearInput()">æ¸…ç©º</button>
        <div id="type-result" class="result"></div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ“œ æ»šåŠ¨éªŒè¯</h2>
        <button class="test-button" onclick="testScroll('down', 300)">å‘ä¸‹æ»šåŠ¨</button>
        <button class="test-button" onclick="testScroll('up', 300)">å‘ä¸Šæ»šåŠ¨</button>
        <button class="test-button" onclick="testScroll({top: true})">æ»šåŠ¨åˆ°é¡¶éƒ¨</button>
        <button class="test-button" onclick="testScroll({bottom: true})">æ»šåŠ¨åˆ°åº•éƒ¨</button>
        <div id="scroll-result" class="result"></div>
    </div>
    
    <div class="scroll-content">
        <h2>é•¿å†…å®¹åŒºåŸŸï¼ˆç”¨äºæ»šåŠ¨æµ‹è¯•ï¼‰</h2>
        <div class="test-area" id="scroll-target">æ»šåŠ¨ç›®æ ‡</div>
        <p>ç»§ç»­å‘ä¸‹æ»šåŠ¨...</p>
        <div class="test-area" id="scroll-target-2">åº•éƒ¨ç›®æ ‡</div>
    </div>
    
    <div class="test-section">
        <h2>ğŸ”„ æ‰¹é‡æ“ä½œéªŒè¯</h2>
        <button class="test-button" onclick="testBatchClick()">æ‰¹é‡ç‚¹å‡»æµ‹è¯•</button>
        <button class="test-button" onclick="testBatchOperate()">å¤æ‚æ‰¹é‡æ“ä½œ</button>
        <button class="test-button" onclick="testDrag()">æ‹–æ‹½æµ‹è¯•</button>
        <div id="batch-result" class="result"></div>
    </div>
    
    <!-- å…ˆåŠ è½½æ‰€æœ‰æ¨¡å— -->
    <script src="dist/modules/coordinate.min.js"></script>
    <script src="dist/modules/detector.min.js"></script>
    <script src="dist/modules/interactor.min.js"></script>
    <script src="dist/modules/scroller.min.js"></script>
    <!-- å†åŠ è½½ç»Ÿä¸€API -->
    <script src="dist/index.js"></script>
    
    <script>
        function updateStatus(message) {
            document.getElementById('status').textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
        }
        
        function showResult(elementId, message, isPass = true) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<span class="${isPass ? 'pass' : 'fail'}">${isPass ? 'âœ…' : 'âŒ'} ${message}</span>`;
        }
        
        // åŠ è½½æ‰€æœ‰æ¨¡å—
        function loadAllModules() {
            updateStatus('åŠ è½½æ‰€æœ‰æ¨¡å—...');
            const modules = ['domToolkitCoordinates', 'domToolkitDetector', 'domToolkitInteractor', 'domToolkitScroller'];
            const loadedModules = modules.filter(name => typeof window[name] !== 'undefined');
            
            if (loadedModules.length === modules.length) {
                showResult('loading-result', `æ‰€æœ‰æ¨¡å—åŠ è½½æˆåŠŸ: ${loadedModules.join(', ')}`);
                updateStatus('âœ… æ¨¡å—åŠ è½½å®Œæˆ');
                testModuleLoading();
            } else {
                showResult('loading-result', `éƒ¨åˆ†æ¨¡å—ç¼ºå¤±: ${modules.filter(m => !loadedModules.includes(m)).join(', ')}`, false);
            }
        }
        
        // æ£€æŸ¥æ¨¡å—çŠ¶æ€
        function testModuleLoading() {
            const modules = {
                'domToolkitCoordinates': 'åæ ‡æ¨¡å—',
                'domToolkitDetector': 'æ£€æµ‹æ¨¡å—', 
                'domToolkitInteractor': 'äº¤äº’æ¨¡å—',
                'domToolkitScroller': 'æ»šåŠ¨æ¨¡å—'
            };
            
            let results = [];
            for (let [name, desc] of Object.entries(modules)) {
                if (typeof window[name] !== 'undefined') {
                    results.push(`${desc}: âœ…`);
                } else {
                    results.push(`${desc}: âŒ`);
                }
            }
            
            showResult('loading-result', results.join(' | '));
        }
        
        // æµ‹è¯•åæ ‡æ˜¾ç¤º
        function testCoordinates() {
            updateStatus('å¯åŠ¨åæ ‡æ˜¾ç¤º...');
            try {
                if (typeof domToolkitCoordinates !== 'undefined' && domToolkitCoordinates.startDisplay) {
                    domToolkitCoordinates.startDisplay();
                    showResult('coordinates-result', 'åæ ‡æ˜¾ç¤ºå¯åŠ¨æˆåŠŸ');
                    updateStatus('âœ… åæ ‡æ˜¾ç¤ºæ­£å¸¸');
                } else {
                    showResult('coordinates-result', 'åæ ‡æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('coordinates-result', `å¯åŠ¨å¤±è´¥: ${error.message}`, false);
            }
        }
        
        function stopCoordinates() {
            try {
                if (typeof domToolkitCoordinates !== 'undefined' && domToolkitCoordinates.stopDisplay) {
                    domToolkitCoordinates.stopDisplay();
                    showResult('coordinates-result', 'åæ ‡æ˜¾ç¤ºå·²åœæ­¢');
                }
            } catch (error) {
                showResult('coordinates-result', `åœæ­¢å¤±è´¥: ${error.message}`, false);
            }
        }
        
        // æµ‹è¯•å…ƒç´ æ£€æµ‹
        function testElementDetection() {
            updateStatus('æµ‹è¯•å…ƒç´ æ£€æµ‹...');
            const target = document.getElementById('detect-target');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitDetector !== 'undefined' && domToolkitDetector.getElementAt) {
                    const element = domToolkitDetector.getElementAt(x, y);
                    if (element && element === target) {
                        showResult('detection-result', `æ£€æµ‹æˆåŠŸ: ${element.tagName} - "${element.textContent}"`);
                        updateStatus('âœ… å…ƒç´ æ£€æµ‹æ­£å¸¸');
                    } else {
                        showResult('detection-result', `æ£€æµ‹å¤±è´¥: æœŸæœ›æ£€æµ‹åˆ°ç›®æ ‡å…ƒç´ `, false);
                    }
                } else {
                    showResult('detection-result', 'æ£€æµ‹æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('detection-result', `æ£€æµ‹é”™è¯¯: ${error.message}`, false);
            }
        }
        
        function testHighlight() {
            updateStatus('æµ‹è¯•å…ƒç´ é«˜äº®...');
            const target = document.getElementById('detect-target');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitDetector !== 'undefined' && domToolkitDetector.highlightAt) {
                    domToolkitDetector.highlightAt(x, y, 2000);
                    showResult('detection-result', 'é«˜äº®æ˜¾ç¤ºæˆåŠŸï¼ˆ2ç§’ï¼‰');
                    updateStatus('âœ… é«˜äº®åŠŸèƒ½æ­£å¸¸');
                } else {
                    showResult('detection-result', 'æ£€æµ‹æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('detection-result', `é«˜äº®é”™è¯¯: ${error.message}`, false);
            }
        }
        
        function startRealtimeDetection() {
            try {
                if (typeof domToolkitDetector !== 'undefined' && domToolkitDetector.startRealtimeDetection) {
                    domToolkitDetector.startRealtimeDetection();
                    showResult('detection-result', 'å®æ—¶æ£€æµ‹å·²å¯åŠ¨ï¼ŒæŒ‰ä½Ctrlé”®ç§»åŠ¨é¼ æ ‡');
                    updateStatus('âœ… å®æ—¶æ£€æµ‹å¯åŠ¨');
                } else {
                    showResult('detection-result', 'æ£€æµ‹æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('detection-result', `å®æ—¶æ£€æµ‹é”™è¯¯: ${error.message}`, false);
            }
        }
        
        // æµ‹è¯•ç‚¹å‡»
        function testClick() {
            updateStatus('æµ‹è¯•è‡ªåŠ¨ç‚¹å‡»...');
            const target = document.getElementById('click-target');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.clickAt) {
                    domToolkitInteractor.clickAt(x, y)
                        .then(() => {
                            showResult('click-result', 'å•ç‚¹æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… ç‚¹å‡»éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('click-result', `ç‚¹å‡»å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('click-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('click-result', `ç‚¹å‡»é”™è¯¯: ${error.message}`, false);
            }
        }
        
        function testDoubleClick() {
            updateStatus('æµ‹è¯•åŒå‡»...');
            const target = document.getElementById('click-target');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.doubleClickAt) {
                    domToolkitInteractor.doubleClickAt(x, y)
                        .then(() => {
                            showResult('click-result', 'åŒå‡»æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… åŒå‡»éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('click-result', `åŒå‡»å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('click-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('click-result', `åŒå‡»é”™è¯¯: ${error.message}`, false);
            }
        }
        
        function testRightClick() {
            updateStatus('æµ‹è¯•å³é”®ç‚¹å‡»...');
            const target = document.getElementById('click-target');
            const rect = target.getBoundingClientRect();
            const x = rect.left + rect.width / 2;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.rightClickAt) {
                    domToolkitInteractor.rightClickAt(x, y)
                        .then(() => {
                            showResult('click-result', 'å³é”®ç‚¹å‡»æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… å³é”®éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('click-result', `å³é”®å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('click-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('click-result', `å³é”®é”™è¯¯: ${error.message}`, false);
            }
        }
        
        // æµ‹è¯•è¾“å…¥
        function testType() {
            updateStatus('æµ‹è¯•è‡ªåŠ¨è¾“å…¥...');
            const input = document.getElementById('test-input');
            const rect = input.getBoundingClientRect();
            const x = rect.left + 10;
            const y = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.typeAt) {
                    domToolkitInteractor.typeAt(x, y, 'è‡ªåŠ¨åŒ–æµ‹è¯•æ–‡æœ¬', { clear: true, typingDelay: 50 })
                        .then(() => {
                            showResult('type-result', 'è‡ªåŠ¨è¾“å…¥æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… è¾“å…¥éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('type-result', `è¾“å…¥å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('type-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('type-result', `è¾“å…¥é”™è¯¯: ${error.message}`, false);
            }
        }
        
        function clearInput() {
            document.getElementById('test-input').value = '';
            showResult('type-result', 'è¾“å…¥æ¡†å·²æ¸…ç©º');
        }
        
        // æµ‹è¯•æ»šåŠ¨
        function testScroll(...args) {
            updateStatus('æµ‹è¯•æ»šåŠ¨åŠŸèƒ½...');
            try {
                if (typeof domToolkit !== 'undefined' && domToolkit.scroll) {
                    domToolkit.scroll(...args)
                        .then(() => {
                            showResult('scroll-result', `æ»šåŠ¨æµ‹è¯•é€šè¿‡: ${JSON.stringify(args)}`);
                            updateStatus('âœ… æ»šåŠ¨éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('scroll-result', `æ»šåŠ¨å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('scroll-result', 'æ»šåŠ¨æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('scroll-result', `æ»šåŠ¨é”™è¯¯: ${error.message}`, false);
            }
        }
        
        // æµ‹è¯•æ‰¹é‡æ“ä½œ
        function testBatchClick() {
            updateStatus('æµ‹è¯•æ‰¹é‡ç‚¹å‡»...');
            const target = document.getElementById('click-target');
            const rect = target.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.batchClick) {
                    const coordinates = [
                        {x: centerX - 20, y: centerY},
                        {x: centerX, y: centerY},
                        {x: centerX + 20, y: centerY}
                    ];
                    
                    domToolkitInteractor.batchClick(coordinates, {delayBetween: 300})
                        .then(() => {
                            showResult('batch-result', 'æ‰¹é‡ç‚¹å‡»æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… æ‰¹é‡æ“ä½œéªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('batch-result', `æ‰¹é‡æ“ä½œå¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('batch-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('batch-result', `æ‰¹é‡æ“ä½œé”™è¯¯: ${error.message}`, false);
            }
        }
        
        function testBatchOperate() {
            updateStatus('æµ‹è¯•å¤æ‚æ‰¹é‡æ“ä½œ...');
            try {
                if (typeof domToolkitScroller !== 'undefined' && domToolkitScroller.scrollAndBatchOperate) {
                    const operations = [
                        {scroll: {top: true}},
                        {scroll: {down: true, distance: 400}},
                        {scroll: {down: true, distance: 400}}
                    ];
                    
                    domToolkitScroller.scrollAndBatchOperate(operations, {scrollDelay: 500, operationDelay: 300})
                        .then(() => {
                            showResult('batch-result', 'å¤æ‚æ‰¹é‡æ“ä½œæµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… å¤æ‚æ‰¹é‡æ“ä½œéªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('batch-result', `å¤æ‚æ‰¹é‡æ“ä½œå¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('batch-result', 'æ»šåŠ¨æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('batch-result', `å¤æ‚æ‰¹é‡æ“ä½œé”™è¯¯: ${error.message}`, false);
            }
        }
        
        function testDrag() {
            updateStatus('æµ‹è¯•æ‹–æ‹½æ“ä½œ...');
            const target = document.getElementById('click-target');
            const rect = target.getBoundingClientRect();
            const startX = rect.left + rect.width / 2;
            const startY = rect.top + rect.height / 2;
            const endX = startX + 100;
            const endY = startY;
            
            try {
                if (typeof domToolkitInteractor !== 'undefined' && domToolkitInteractor.dragFromTo) {
                    domToolkitInteractor.dragFromTo(startX, startY, endX, endY, {duration: 500})
                        .then(() => {
                            showResult('batch-result', 'æ‹–æ‹½æµ‹è¯•é€šè¿‡');
                            updateStatus('âœ… æ‹–æ‹½éªŒè¯é€šè¿‡');
                        })
                        .catch(err => {
                            showResult('batch-result', `æ‹–æ‹½å¤±è´¥: ${err.message}`, false);
                        });
                } else {
                    showResult('batch-result', 'äº¤äº’æ¨¡å—æœªåŠ è½½', false);
                }
            } catch (error) {
                showResult('batch-result', `æ‹–æ‹½é”™è¯¯: ${error.message}`, false);
            }
        }
        
        // é¡µé¢åŠ è½½åè‡ªåŠ¨åŠ è½½æ¨¡å—
        window.addEventListener('load', function() {
            setTimeout(() => {
                loadAllModules();
            }, 500);
        });
    </script>
</body>
</html>