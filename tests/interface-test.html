<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥å£æµ‹è¯• - DOM Toolkit</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            line-height: 1.6;
        }
        .test-section {
            background: #f5f5f5;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #2196F3;
        }
        button {
            margin: 5px;
            padding: 8px 15px;
            cursor: pointer;
            background: #2196F3;
            color: white;
            border: none;
            border-radius: 3px;
            transition: background 0.3s;
        }
        button:hover {
            background: #1976D2;
        }
        .result {
            background: white;
            padding: 10px;
            margin: 10px 0;
            border-radius: 3px;
            border-left: 4px solid #4CAF50;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .error {
            border-left-color: #f44336;
            background: #ffebee;
        }
        .warning {
            border-left-color: #ff9800;
            background: #fff3e0;
        }
        .info {
            border-left-color: #2196F3;
            background: #e3f2fd;
        }
        .test-title {
            color: #1976D2;
            margin-bottom: 15px;
            border-bottom: 2px solid #e3f2fd;
            padding-bottom: 5px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .module-info {
            background: #e8f5e8;
            padding: 10px;
            border-radius: 3px;
            margin: 10px 0;
            font-size: 12px;
        }
        .summary {
            background: #f0f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª DOM Toolkit æ¥å£æµ‹è¯•</h1>
    
    <div class="info">
        <strong>è¯´æ˜ï¼š</strong>æ­¤é¡µé¢æµ‹è¯• DOM Toolkit çš„æ‰€æœ‰æ¥å£ï¼ŒåŒ…æ‹¬ä¸»åŒ…ç»Ÿä¸€æ¥å£å’Œå„ä¸ªç‹¬ç«‹æ¨¡å—ã€‚
    </div>
    
    <div class="test-section">
        <h2 class="test-title">ğŸ“‹ æ¨¡å—åŠ è½½çŠ¶æ€</h2>
        <button onclick="checkModuleLoading()">æ£€æŸ¥æ¨¡å—åŠ è½½çŠ¶æ€</button>
        <div id="loading-results"></div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">ğŸ¯ ä¸»åŒ…æ¥å£æ£€æŸ¥</h2>
        <button onclick="testMainInterfaces()">æµ‹è¯•ä¸»åŒ…ç»Ÿä¸€æ¥å£</button>
        <div id="main-results"></div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">ğŸ§© ç‹¬ç«‹æ¨¡å—æ¥å£æ£€æŸ¥</h2>
        <button onclick="testModuleInterfaces()">æµ‹è¯•ç‹¬ç«‹æ¨¡å—æ¥å£</button>
        <div id="module-results"></div>
    </div>
    
    <div class="test-section">
        <h2 class="test-title">âš¡ åŠŸèƒ½æµ‹è¯•</h2>
        <button onclick="testClick()">ç‚¹å‡»æµ‹è¯• (100, 100)</button>
        <button onclick="testScroll()">æ»šåŠ¨æµ‹è¯•</button>
        <button onclick="testCoordinates()">åæ ‡æ˜¾ç¤ºæµ‹è¯•</button>
        <button onclick="testDetector()">å…ƒç´ æ£€æµ‹æµ‹è¯•</button>
        <button onclick="testBatch()">æ‰¹é‡æ“ä½œæµ‹è¯•</button>
        <div id="function-results"></div>
    </div>

    <!-- åŠ è½½æ‰€æœ‰å¿…è¦çš„æ¨¡å— -->
    <script src="../dist/index.js"></script>
    <script src="../dist/modules/coordinate.min.iife.js"></script>
    <script src="../dist/modules/detector.min.iife.js"></script>
    <script src="../dist/modules/interactor.min.iife.js"></script>
    <script src="../dist/modules/scroller.min.iife.js"></script>
    
    <script>
        function addResult(containerId, message, type = 'success') {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            
            // è®¾ç½®æ ·å¼ç±»
            switch(type) {
                case 'error':
                    div.className = 'result error';
                    break;
                case 'warning':
                    div.className = 'result warning';
                    break;
                case 'info':
                    div.className = 'result info';
                    break;
                default:
                    div.className = 'result';
            }
            
            div.textContent = message;
            container.appendChild(div);
        }

        function addLoading(containerId, message) {
            const container = document.getElementById(containerId);
            const div = document.createElement('div');
            div.className = 'result loading';
            div.textContent = message;
            container.appendChild(div);
        }

        function clearResults(containerId) {
            document.getElementById(containerId).innerHTML = '';
        }

        function checkModuleLoading() {
            const results = document.getElementById('loading-results');
            results.innerHTML = '';
            
            const modules = [
                { name: 'domToolkit', obj: window.domToolkit, description: 'ä¸»åŒ…ç»Ÿä¸€æ¥å£' },
                { name: 'domToolkitCoordinates', obj: window.domToolkitCoordinates, description: 'åæ ‡æ¨¡å—' },
                { name: 'domToolkitDetector', obj: window.domToolkitDetector, description: 'æ£€æµ‹æ¨¡å—' },
                { name: 'domToolkitInteractor', obj: window.domToolkitInteractor, description: 'äº¤äº’æ¨¡å—' },
                { name: 'domToolkitScroller', obj: window.domToolkitScroller, description: 'æ»šåŠ¨æ¨¡å—' }
            ];
            
            let loadedCount = 0;
            modules.forEach(module => {
                if (module.obj && typeof module.obj === 'object') {
                    addResult('loading-results', `âœ… ${module.name} - ${module.description} å·²åŠ è½½`);
                    loadedCount++;
                } else {
                    addResult('loading-results', `âŒ ${module.name} - ${module.description} æœªåŠ è½½`, 'error');
                }
            });
            
            if (loadedCount === modules.length) {
                addResult('loading-results', 'ğŸ‰ æ‰€æœ‰æ¨¡å—åŠ è½½æˆåŠŸï¼', 'success');
            } else {
                addResult('loading-results', `âš ï¸ åªæœ‰ ${loadedCount}/${modules.length} ä¸ªæ¨¡å—åŠ è½½æˆåŠŸ`, 'warning');
            }
        }

        function testMainInterfaces() {
            clearResults('main-results');
            addLoading('main-results', 'æ­£åœ¨æµ‹è¯•ä¸»åŒ…æ¥å£...');
            
            setTimeout(() => {
                clearResults('main-results');
                
                const expectedInterfaces = [
                    'click', 'clickAt', 'doubleClick', 'rightClick', 'type', 'drag', 'batch',
                    'scroll', 'scrollBy', 'scrollToElement', 'getPosition', 'getScrollPosition',
                    'scrollAndClick', 'batchOperate', 'coordinates', 'detector'
                ];
                
                let passedCount = 0;
                expectedInterfaces.forEach(method => {
                    if (typeof domToolkit[method] === 'function') {
                        addResult('main-results', `âœ… ${method}() - å‡½æ•°å­˜åœ¨`);
                        passedCount++;
                    } else if (typeof domToolkit[method] === 'object') {
                        addResult('main-results', `âœ… ${method} - å¯¹è±¡å±æ€§å­˜åœ¨`);
                        passedCount++;
                    } else {
                        addResult('main-results', `âŒ ${method} - ç¼ºå¤±`, 'error');
                    }
                });
                
                if (passedCount === expectedInterfaces.length) {
                    addResult('main-results', `ğŸ‰ æ‰€æœ‰ä¸»åŒ…æ¥å£æµ‹è¯•é€šè¿‡ï¼(${passedCount}/${expectedInterfaces.length})`, 'success');
                } else {
                    addResult('main-results', `âš ï¸ ä¸»åŒ…æ¥å£æµ‹è¯•: ${passedCount}/${expectedInterfaces.length} é€šè¿‡`, 'warning');
                }
            }, 100);
        }

        function testModuleInterfaces() {
            clearResults('module-results');
            addLoading('module-results', 'æ­£åœ¨æµ‹è¯•ç‹¬ç«‹æ¨¡å—æ¥å£...');
            
            setTimeout(() => {
                clearResults('module-results');
                
                let totalTests = 0;
                let passedTests = 0;
                
                // æµ‹è¯•åæ ‡æ¨¡å—
                const coordinateMethods = ['startDisplay', 'stopDisplay', 'getPosition'];
                coordinateMethods.forEach(method => {
                    totalTests++;
                    if (typeof window.domToolkitCoordinates?.[method] === 'function') {
                        addResult('module-results', `âœ… domToolkitCoordinates.${method}() - å­˜åœ¨`);
                        passedTests++;
                    } else {
                        addResult('module-results', `âŒ domToolkitCoordinates.${method}() - ç¼ºå¤±`, 'error');
                    }
                });
                
                // æµ‹è¯•æ£€æµ‹æ¨¡å—
                const detectorMethods = ['getElementAt', 'highlightAt', 'startRealtimeDetection', 'stopRealtimeDetection'];
                detectorMethods.forEach(method => {
                    totalTests++;
                    if (typeof window.domToolkitDetector?.[method] === 'function') {
                        addResult('module-results', `âœ… domToolkitDetector.${method}() - å­˜åœ¨`);
                        passedTests++;
                    } else {
                        addResult('module-results', `âŒ domToolkitDetector.${method}() - ç¼ºå¤±`, 'error');
                    }
                });
                
                // æµ‹è¯•äº¤äº’æ¨¡å—
                const interactorMethods = ['clickAt', 'doubleClick', 'rightClick', 'type', 'drag', 'batch'];
                interactorMethods.forEach(method => {
                    totalTests++;
                    if (typeof window.domToolkitInteractor?.[method] === 'function') {
                        addResult('module-results', `âœ… domToolkitInteractor.${method}() - å­˜åœ¨`);
                        passedTests++;
                    } else {
                        addResult('module-results', `âŒ domToolkitInteractor.${method}() - ç¼ºå¤±`, 'error');
                    }
                });
                
                // æµ‹è¯•æ»šåŠ¨æ¨¡å—
                const scrollerMethods = ['getScrollPosition', 'scroll', 'scrollBy', 'scrollToElement', 'scrollToPosition', 'scrollAndClick', 'batchOperate'];
                scrollerMethods.forEach(method => {
                    totalTests++;
                    if (typeof window.domToolkitScroller?.[method] === 'function') {
                        addResult('module-results', `âœ… domToolkitScroller.${method}() - å­˜åœ¨`);
                        passedTests++;
                    } else {
                        addResult('module-results', `âŒ domToolkitScroller.${method}() - ç¼ºå¤±`, 'error');
                    }
                });
                
                if (passedTests === totalTests) {
                    addResult('module-results', `ğŸ‰ æ‰€æœ‰ç‹¬ç«‹æ¨¡å—æ¥å£æµ‹è¯•é€šè¿‡ï¼(${passedTests}/${totalTests})`, 'success');
                } else {
                    addResult('module-results', `âš ï¸ ç‹¬ç«‹æ¨¡å—æ¥å£æµ‹è¯•: ${passedTests}/${totalTests} é€šè¿‡`, 'warning');
                }
            }, 100);
        }

        async function testClick() {
            try {
                addResult('function-results', 'ğŸ”„ æ­£åœ¨æ‰§è¡Œç‚¹å‡»æµ‹è¯•...', 'info');
                const result = await domToolkit.click(100, 100);
                addResult('function-results', `âœ… ç‚¹å‡»æˆåŠŸ: ${JSON.stringify(result)}`);
            } catch (error) {
                addResult('function-results', `âŒ ç‚¹å‡»å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testScroll() {
            try {
                addResult('function-results', 'ğŸ”„ æ­£åœ¨æ‰§è¡Œæ»šåŠ¨æµ‹è¯•...', 'info');
                
                // æ£€æŸ¥æ¨¡å—æ˜¯å¦æ­£ç¡®åŠ è½½
                if (!window.domToolkitScroller) {
                    addResult('function-results', 'âŒ scroller æ¨¡å—æœªåŠ è½½', 'error');
                    return;
                }
                
                const position = domToolkit.getPosition();
                addResult('function-results', `âœ… å½“å‰ä½ç½®: x=${position.x}, y=${position.y}`);
                
                // æµ‹è¯• scrollBy æ–¹æ³•
                await domToolkit.scrollBy(0, 50);
                addResult('function-results', 'âœ… ç›¸å¯¹æ»šåŠ¨å‘ä¸‹æ‰§è¡ŒæˆåŠŸ');
                
                // ç­‰å¾…ä¸€ä¸‹å†æ»šåŠ¨å›åŸä½ç½®
                await new Promise(resolve => setTimeout(resolve, 500));
                await domToolkit.scrollBy(0, -50);
                addResult('function-results', 'âœ… ç›¸å¯¹æ»šåŠ¨å‘ä¸Šæ‰§è¡ŒæˆåŠŸ');
                
                // æµ‹è¯• scroll æ–¹æ³•
                await domToolkit.scroll('down', 100);
                addResult('function-results', 'âœ… æ–¹å‘æ»šåŠ¨å‘ä¸‹æ‰§è¡ŒæˆåŠŸ');
                
                await domToolkit.scroll('up', 100);
                addResult('function-results', 'âœ… æ–¹å‘æ»šåŠ¨å‘ä¸Šæ‰§è¡ŒæˆåŠŸ');
                
                addResult('function-results', 'ğŸ‰ æ‰€æœ‰æ»šåŠ¨æµ‹è¯•å®Œæˆ');
            } catch (error) {
                addResult('function-results', `âŒ æ»šåŠ¨å¤±è´¥: ${error.message}`, 'error');
                console.error('Scroll test detailed error:', error);
            }
        }

        function testCoordinates() {
            try {
                addResult('function-results', 'ğŸ”„ æ­£åœ¨å¯åŠ¨åæ ‡æ˜¾ç¤º...', 'info');
                window.domToolkitCoordinates.startDisplay();
                addResult('function-results', 'âœ… åæ ‡æ˜¾ç¤ºå·²å¯åŠ¨ï¼ˆ3ç§’åè‡ªåŠ¨åœæ­¢ï¼‰');
                
                setTimeout(() => {
                    window.domToolkitCoordinates.stopDisplay();
                    addResult('function-results', 'âœ… åæ ‡æ˜¾ç¤ºå·²åœæ­¢');
                }, 3000);
            } catch (error) {
                addResult('function-results', `âŒ åæ ‡æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function testDetector() {
            try {
                addResult('function-results', 'ğŸ”„ æ­£åœ¨æµ‹è¯•å…ƒç´ æ£€æµ‹...', 'info');
                
                // æ£€æµ‹å½“å‰é¡µé¢æ ‡é¢˜å…ƒç´ 
                const elementInfo = window.domToolkitDetector.getElementAt(window.innerWidth / 2, 50);
                if (elementInfo) {
                    addResult('function-results', `âœ… æ£€æµ‹åˆ°å…ƒç´ : ${elementInfo.tagName} (ID: ${elementInfo.id}, ç±»: ${elementInfo.className})`);
                    
                    // é«˜äº®æ˜¾ç¤ºè¯¥å…ƒç´ 
                    window.domToolkitDetector.highlightAt(window.innerWidth / 2, 50, 1000);
                    addResult('function-results', 'âœ… å…ƒç´ é«˜äº®æ˜¾ç¤ºæˆåŠŸ');
                } else {
                    addResult('function-results', 'âŒ æœªæ£€æµ‹åˆ°å…ƒç´ ', 'warning');
                }
            } catch (error) {
                addResult('function-results', `âŒ å…ƒç´ æ£€æµ‹å¤±è´¥: ${error.message}`, 'error');
            }
        }

        async function testBatch() {
            try {
                addResult('function-results', 'ğŸ”„ æ­£åœ¨æ‰§è¡Œæ‰¹é‡æ“ä½œæµ‹è¯•...', 'info');
                
                const operations = [
                    { click: { x: 100, y: 100, options: { delay: 100 } } },
                    { click: { x: 200, y: 100, options: {} } }
                ];
                
                const results = await domToolkit.batch(operations, {
                    delayBetween: 200
                });
                
                addResult('function-results', `âœ… æ‰¹é‡æ“ä½œæˆåŠŸ: ${results.length} ä¸ªæ“ä½œå®Œæˆ`);
            } catch (error) {
                addResult('function-results', `âŒ æ‰¹é‡æ“ä½œå¤±è´¥: ${error.message}`, 'error');
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æŸ¥æ¨¡å—åŠ è½½çŠ¶æ€
        window.addEventListener('load', () => {
            setTimeout(checkModuleLoading, 500);
        });
    </script>
</body>
</html>